// INDEX

.stages
  position: relative
  flex: 1 1 auto
  display: flex
  flex-direction: column

// .stage
//   position: relative
//   flex: 1 1 auto
//   display: flex
//   flex-direction: column

// PHOTOS
.stage-photos
  position: fixed
  z-index: 5
  top: 0
  left: 0
  right: 0
  pointer-events: none
  &__wrapper
    position: relative
    img
      position: fixed
      top: -5vh
      left: 0
      width: 100%
      transform-origin: top center
      opacity: 0
      pointer-events: none
      transform: translate3d(0,-100%,0)
      transition: transform .5s ease-in, opacity .3s linear
      &.is-active
        // !!! refactor
        pointer-events: all
        opacity: 1
        transform: translate3d(0,0%,0)
      &.is-hovered
        cursor: pointer
        transform: translate3d(0,0,0) scale(1.02)

+r($xl)
  .stage-photos
    &__wrapper
      img
        top: 0

+r($tablet)
  .stage-photos
    display: none


// STAGE SLIDER
.stage-slider
  z-index: 4
  font-size: 0

.stage-slide
  position: relative
  min-height: 1000px
  height: 100vh
  overflow: hidden

+r($hd)
  .stage-slide
    min-height: 900px

+r($wide)
  .stage-slide
    min-height: 750px

+r($tablet)
  .stage-slide
    min-height: 100vh
    height: auto

+r($tablet)
  .stage-slider
    .slick-track
      display: flex
    .slick-slide
      height: auto
      display: flex
      flex-direction: column
      > div
        flex: 1 0 auto
        display: flex
        flex-direction: column

    .stage-slide
      flex: 1 0 auto
      display: flex !important
      flex-direction: column

.stages
  &::after
    display: inline-block
    content: ' '
    position: absolute
    top: 0
    left: 0
    right: 0
    z-index: 1
    bottom: calc(5vh + 84px + 150px)
    background: linear-gradient( to bottom, #ded5c5 0%, #d8bb91 100%)
    transition: background .2s ease

+r($wide)
  .stages
    &::after
      bottom: calc(5vh + 64px + 80px)

+r($desktop)
  .stages
    &::after
      bottom: calc(5vh + 54px + 60px)

+r($tablet)
  .stages
    &::after
      bottom: 0



// BG
.stage-background
  position: absolute
  display: flex
  align-items: flex-end
  width: 100vw
  top: auto
  // stage nav + road offset - 10 road boarder
  bottom: calc(5vh + 84px + 160px)
  z-index: 10
  pointer-events: none
  img
    // flex: 0 1 100%
    width: 100vw
    // width: 100%
    height: auto
    &.buildings
      +rmin($tablet)
        width: auto
        max-width: 100%
        max-height: 55vh

  // &__city, &__trees
  &__trees
    position: absolute
    bottom: 0
    left: 0
    right: 0
    width: 200%
    animation-iteration-count: infinite
    animation-timing-function: linear
    animation-name: bg-scrolling
    background-repeat: repeat-x
    background-size: 50% 100%
    background-position: 0 0

    img
      opacity: 0
  // &__city
  //   background-image: url('../img/stageBg-1-1.png'), url('../img/stageBg-1-1.png')
  //   z-index: 1
  //   animation-duration: 40s
  //   animation-name: none
  &__trees
    background-image: url('../img/stageBg-1-2.png'), url('../img/stageBg-1-2.png')
    z-index: 2
    animation-duration: 55s

@keyframes bg-scrolling
  100%
    //background-position: -100% 0
    transform: translate3d(-50%,0,0)


+r($wide)
  .stage-background
    bottom: calc(5vh + 64px + 112px)

+r($w1200)
  .stage-background
    bottom: calc(5vh + 64px + 100px)

+r($desktop)
  .stage-background
    bottom: calc(5vh + 54px + 86px)

+r($tablet)
  .stage-background
    position: static
    margin-top: auto

// STAGE BACKGROUND CONTROLS + COLOR
.stages
  &[data-stage="2"]
    &::after
      background: linear-gradient( to top, rgb(252,234,136) 0%, rgb(157,192,196) 100%)
  &[data-stage="3"]
    &::after
      background: linear-gradient( to top, rgb(252,161,136) 0%, rgb(246,205,169) 100%)
    &::before
      display: inline-block
      content: ' '
      position: absolute
      top: 0
      left: 0
      right: 0
      bottom: 0
      z-index: 2
      mix-blend-mode: lighten
      background: url('../img/stage3BgBefore.png') no-repeat center
      background-size: cover

  &[data-stage="4"]
    &::after
      background: linear-gradient( to top, rgb(210,252,136) 0%, rgb(129,142,78) 100%)

  &[data-stage="5"]
    &::after
      background: linear-gradient( to bottom, rgb(81,3,5) 0%, rgb(201,2,7) 100%)

  &[data-stage="6"]
    &::after
      background: linear-gradient( to top, rgb(0,204,163) 0%, rgb(128,210,82) 34%, rgb(255,216,0) 100%)
  &[data-stage="7"]
    &::after
      background: linear-gradient( to top, rgb(255,242,223) 0%, rgb(224,247,235) 62%, rgb(192,252,247) 100%)

  &[data-stage="8"]
    &::after
      background: linear-gradient( to bottom, rgb(243,246,160) 0%, rgb(236,205,238) 100%)
  &[data-stage="9"]
    &::after
      background: linear-gradient( to top, rgb(218,147,88) 0%, rgb(130,50,192) 100%)
  &[data-stage="10"]
    &::after
      background: linear-gradient( to top, rgb(133,206,113) 0%, rgb(63,167,197) 100%)
  &[data-stage="11"]
    &::after
      background: linear-gradient( to top, rgb(133,206,113) 0%, rgb(63,167,197) 100%)
  &[data-stage="12"]
    &::after
      background: linear-gradient( to top, rgb(133,206,113) 0%, rgb(63,167,197) 100%)


.stage-text
  &:hover
    transition: transform .1s ease-in, opacity .1s linear
    transform: scale(1.01)
.stage-text__short
  position: relative
  .px
    position: absolute;
    left: 0
    top: 0
    width: 100%
    height: 100%

.stage-slide
  &[data-stage="2"]
    .stage-text
      color: #3c5460
  &[data-stage="3"]
    .stage-text
      color: #f93115
      &__short
        color: #8a1211
    .stage-timeline__road
      background-image: url('../img/roadStage3.png')
  &[data-stage="4"]
    .stage-text
      color: #566229
  &[data-stage="5"]
    .stage-text
      color: white
    .stage-timeline__road
      background-image: url('../img/roadStage5.png')
  &[data-stage="6"]
    .stage-text
      color: #059d7b
  &[data-stage="7"]
    .stage-text
      color: #a17e4d
  &[data-stage="8"]
    .stage-text
      color: #416a9e
  &[data-stage="9"]
    .stage-text
      color: #fdf9d0
  &[data-stage="10"]
    .stage-text
      color: #fff9bd
  &[data-stage="11"]
    .stage-text
      color: #566229
  &[data-stage="12"]
    .stage-text
      color: #566229



// TEXT
.stage-text
  position: absolute
  width: 100vw
  top: 0
  bottom: calc(5vh + 84px + 100px)
  display: flex
  align-items: center
  color: $colorRed
  z-index: 20
  pointer-events: none
  &__wrapper
    display: block
    margin: auto 3.3% auto 50%
    padding: 30px 0px 30px 50px
    cursor: pointer
    pointer-events: all

  &__top
    display: flex
    align-items: flex-end
    width: 100%
    &:hover
      .stage-text__title
        text-decoration: none
        // span::after
        //   opacity: 0
        //   bottom: 5px
  &__title
    // width: 100%
    font-size: 67px
    font-family: 'a_BodoniOrtoTitul', serif
    text-transform: uppercase
    max-width: 42.7vw
    // overflow: hidden
    // text-overflow: ellipsis
    // text-decoration: underline
    // span
    //   position: relative
    //   &::after
    //     display: inline-block
    //     content: ' '
    //     position: absolute
    //     bottom: 2px
    //     height: 3px
    //     left: 0
    //     right: 0
    //     z-index: 1
    //     background: currentColor
    //     transition: all $transitionSpeed ease-out
  &__short
    margin-top: 30px
    font-size: 20px
  &__logo
    flex: 0 1 250px
    margin-left: 5%
    img
      max-width: 100%
  &__mobile
    display: none
    cursor: pointer
    pointer-events: all
    margin: 70px -50px
    width: calc(100% + 100px)
  .link-more
    display: none
    font-style: italic
    font-weight: bold
    text-align: right
    text-decoration: underline
    +r($desktop)
      display: block

+r($xl)
  .stage-text
    &__title
      font-size: 60px
      &.small-title
        font-size: 50px
    &__short
      font-size: 18px

+r($hd)
  .stage-text
    &__title
      font-size: 50px
      &.small-title
        font-size: 40px
    &__short
      font-size: 16px

+r($wide)
  .stage-text
    bottom: calc(5vh + 64px + 80px)
    &__title
      font-size: 46px
      &.small-title
        font-size: 36px
    &__short
      font-size: 14px

+r($w1200)
  .stage-text
    &__title
      font-size: 40px
      &.small-title
        font-size: 30px

+r($desktop)
  .stage-text
    bottom: calc(5vh + 54px + 60px)
    &__title
      font-size: 38px
    &__short
      font-size: 12px

+r($tablet)
  .stage-text
    position: static
    align-items: flex-start
    pointer-events: all
    &__wrapper
      flex: 0 0 auto
      max-width: 100vw
      margin: 100px 0 100px 0
      padding: 30px 50px 30px 50px
    &__mobile
      display: block
    &__title
      width: 100%
      max-width: calc(100vw - 60px)
      font-size: 60px
      margin-right: auto
    &__short
      font-size: 24px
    &__top
      flex-direction: row-reverse
      align-items: center
    &__logo
      margin-left: 0
      margin-right: 5%

+r($mobile)
  .stage-text
    &__wrapper
      padding-left: 30px
      padding-right: 30px
      margin: 60px 0
    &__title
      font-size: 42px
      margin-right: 0
    &__short
      font-size: 20px
    &__top
      width: auto
      flex-direction: column-reverse
      align-items: flex-start
    &__logo
      flex: 0 0 auto
      margin-left: 0
      margin-right: 0
      margin-bottom: 40px

    &__mobile
      margin: 50px -30px
      width: calc(100% + 60px)


+r($mobile-s)
  .stage-text
    &__wrapper
      padding-left: 20px
      padding-right: 20px
      margin: 40px 0
    &__title
      font-size: 34px
      max-width: calc(100vw - 40px)

    &__mobile
      margin: 50px -20px
      width: calc(100% + 40px)

+r(374)
  .stage-text
    &__title
      font-size: 28px
    &__short
      font-size: 17px


// TIMELINE
.stage-timeline
  position: absolute
  width: 100vw
  z-index: 30
  top: auto
  // stage nav offset
  bottom: calc(5vh + 84px)
  &__wrapper
    position: relative
    display: flex
  &__road
    position: absolute
    bottom: 0
    left: 0
    right: 0
    z-index: 1
    display: flex
    align-items: flex-start
    width: 300%
    font-size: 0
    transform: translate3d(0,0,0)
    animation-name: roadAnimation
    animation-duration: 30s
    animation-fill-mode: forwards
    animation-direction: normal
    animation-timing-function: linear
    animation-iteration-count: infinite
    backface-visibility: hidden
    transform-style: preserve-3d
    // img
    //   width: 100%
    background-image: url('../img/road.png')
    background-repeat: repeat-x
    background-position: 0 0
    background-size: 50% 100%
    img
      opacity: 0

  &__cars
    width: 100vw
    display: flex
    position: relative
    left: 0
    right: 0
    z-index: 2

@keyframes roadAnimation
  100%
    background-position: -100% 0

// @keyframes roadAnimation
//   0%
//     transform: translate3d(0,0,0)
//   100%
//     transform: translate3d(-33.3333%,0,0)

+r($wide)
  .stage-timeline
    bottom: calc(5vh + 64px)
    &__road
      img
        max-width: 1336px

+r($w1200)
  .stage-timeline
    &__road
      img
        max-width: 1200px

+r($desktop)
  .stage-timeline
    bottom: calc(5vh + 54px)
    &__road
      img
        max-width: 1024px

+r($tablet)
  .stage-timeline
    position: static
    &__wrapper
      min-height: 350px
    &__road
      overflow: hidden
      img
        max-width: 200%
        height: 350px
    &__cars
      flex: 0 0 auto
      display: block

+r($mobile)
  .stage-timeline
    &__wrapper
      min-height: 250px
    &__road
      img
        height: 250px

+r($mobile-s)
  .stage-timeline
    &__wrapper
      min-height: 200px
    &__road
      img
        height: 200px


// STAGE MOBILE NAV
.stage-m-nav
  display: none
  position: relative
  z-index: 10
  background-image: linear-gradient( 90deg, rgb(222,213,196) 0%, rgb(216,187,145) 100%)
  padding: 65px 40px 50px 40px


  &__prev, &__next
    display: flex
    align-items: center
    cursor: pointer
    span
      display: inline-block
      font-family: 'a_BodoniOrtoTitul', serif
      font-size: 24px
      color: $colorRed
      text-decoration: underline
    .icon
      transition: transform $transitionSpeed $ease
    &:hover
      span
        text-decoration: none

  &__prev
    span
      margin-left: 10px
    &:hover
      .icon
        transform: translate3d(-20px,0,0)

  &__next
    text-align: right
    margin-left: auto
    span
      margin-right: 10px
    &:hover
      .icon
        transform: translate3d(20px,0,0)


+r($tablet)
  .stage-m-nav
    display: flex

+r(800)
  .stage-m-nav
    padding: 45px 20px 40px 20px
    &__prev, &__next
      span
        font-size: 20px
      .icon
        transform: scale(.6)

+r($mobile)
  .stage-m-nav
    padding: 25px 0px 20px 0px
    &__prev, &__next
      span
        font-size: 16px
      .icon
        transform: scale(.45)
    &__prev
      span
        margin-left: 0px
      &:hover
        .icon
          transform: scale(.45) translate3d(-20px,0,0)

    &__next
      span
        margin-right: 0px
      &:hover
        .icon
          transform: scale(.45) translate3d(20px,0,0)

+r(450)
  .stage-m-nav
    &__prev, &__next
      span
        font-size: 12px
      .icon
        transform: scale(.35)
    &__prev
      span
        margin-left: -15px
      &:hover
        .icon
          transform: scale(.35) translate3d(-20px,0,0)

    &__next
      span
        margin-right: -15px
      &:hover
        .icon
          transform: scale(.35) translate3d(20px,0,0)

    // flex-direction: column
    // padding: 0px 0px 0px 0px
    // &__next
    //   margin-top: -50px

+r(375)
  .stage-m-nav
    &__prev, &__next
      margin-top: -25px
      margin-bottom: -25px
      span
        font-size: 11px

.is-active
  cursor: pointer

.close-popup
  position: absolute
  right: 20px
  top: 20px
  width: 32px
  height: 32px
  z-index: 100

+r($tablet)
  .close-popup
    display: none